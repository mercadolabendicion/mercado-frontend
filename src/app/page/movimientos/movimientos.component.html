<div class="contenedor">
  <div class="row">
    <div class="col-6">
      <h1>Gestión de movimientos</h1>
      <p>Administre aquí los ingresos y egresos del negocio</p>
    </div>
    <div class="col-6">
      <div class="row">
        <!-- Tarjetas de resumen con diseño moderno -->
        <div class="summary-cards">
          <div class="summary-card ventas">
            <div class="card-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
              </svg>
            </div>
            <div class="card-content">
              <p class="card-label">Ventas</p>
              <h3 class="card-value">{{ totalVentas | currency : "USD" : "symbol" : "1.0-0" }}</h3>
            </div>
          </div>

          <div class="summary-card externo">
            <div class="card-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4" />
                <path d="M3 5v14a2 2 0 0 0 2 2h16v-5" />
                <path d="M18 12a2 2 0 0 0 0 4h4v-4Z" />
              </svg>
            </div>
            <div class="card-content">
              <p class="card-label">Externo</p>
              <h3 class="card-value">{{ totalExterno | currency : "USD" : "symbol" : "1.0-0" }}</h3>
            </div>
          </div>

          <div class="summary-card efectivo">
            <div class="card-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect width="20" height="14" x="2" y="5" rx="2" />
                <line x1="2" x2="22" y1="10" y2="10" />
              </svg>
            </div>
            <div class="card-content">
              <p class="card-label">Efectivo</p>
              <h3 class="card-value">{{ totalEfectivo | currency : "USD" : "symbol" : "1.0-0" }}</h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row align-items-center">
    <div class="col-12 col-md-6">
      <div class="row">
        <div class="col-12 col-md-6 col-lg-6">
          <button class="btn-action btn-ingreso" (click)="triggerToggleCollapse()" (click)="mostrarModal('ingreso')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 5v14M5 12h14" />
            </svg>
            Agregar ingreso
          </button>
        </div>
        <div class="col-12 col-md-6 col-lg-6">
          <button class="btn-action btn-egreso" (click)="triggerToggleCollapse()" (click)="mostrarModal('egreso')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 5v14M5 12h14" />
            </svg>
            Agregar egreso
          </button>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6">
      <div class="d-flex justify-content-end w-100">
        <div class="filter-input-group d-flex align-items-center">
          <label for="fechaFiltro" class="filter-label mb-0">
            Filtrar por fecha:
          </label>
          <input type="date" class="filter-input" id="fechaFiltro" [(ngModel)]="fechaFiltro"
            (ngModelChange)="onFechaChange()" />
        </div>
      </div>
    </div>
  </div>

  <p class="filter-info">Mostrando movimientos del: <strong>{{ fechaFiltro | date: 'dd/MM/yyyy' }}</strong></p>


  <div class="table-wrapper">
    <div class="table-container">
      <table class="modern-table">
        <thead>
          <tr>
            <th>Fecha y Hora</th>
            <th>Motivo</th>
            <th>Valor</th>
            <th>Tipo</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let movimiento of movimientosFiltrados">
            <td>{{ movimiento.fechaHora }}</td>
            <td>{{ movimiento.motivo }}</td>
            <td class="valor-cell">{{ movimiento.valor | currency : "USD" : "symbol" : "1.0-0" }}</td>
            <td>
              <span class="badge" [ngClass]="{
                'badge-ingreso': movimiento.tipo === 'Ingreso',
                'badge-egreso': movimiento.tipo === 'Egreso'
              }">
                {{ movimiento.tipo }}
              </span>
            </td>
          </tr>
          <tr *ngIf="movimientosFiltrados.length === 0">
            <td colspan="4" class="empty-state">
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 6v6l4 2" />
              </svg>
              <p>No hay movimientos para la fecha seleccionada</p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="footer-actions">
    <button class="btn-report" (click)="generarReporte()">
      Generar reporte
    </button>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="ingresoModal">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">{{ modalTitle }}</h5>
      <span class="close" (click)="ocultarModal()">&times;</span>
    </div>
    <div class="modal-body">
      <form>
        <div class="form-group">
          <label for="valor">Valor:</label>
          <input type="text" class="form-control" id="valor" [value]="valorFormateado"
            (input)="formatearValor($event)" />
        </div>

        <div class="form-group">
          <label for="motivo">Motivo:</label>
          <textarea class="form-control" id="motivo"></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="ocultarModal()">
        Cerrar
      </button>
      <button type="button" class="btn btn-primary" (click)="procesarTransaccion()">
        {{ actionButtonText }}
      </button>
    </div>
  </div>
</div>